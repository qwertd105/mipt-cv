# Домашнее задание 1: Тренировочный цикл и *linear probe* на ViT-Tiny

### Цель

Научиться строить тренировочный цикл в PyTorch, проводить sanity-checks, работать с предобученными моделями и сравнивать простую CNN с линейным классификатором (*linear probe*) поверх ViT-Tiny.

---

### Задание

1. **Подготовка данных**

   * Соберите или выберите мини-датасет (не менее 5 классов, ≥100 изображений на класс).
   * Разбейте на `train/val`, используйте формат `ImageFolder`.
   * Реализуйте базовые аугментации: `RandomResizedCrop`, `RandomHorizontalFlip`, нормализацию.

2. **Тренировочный цикл (CNN)**

   * Реализуйте простую CNN (2–3 свёрточных слоя + классификатор).
   * Добавьте фиксированные сиды, sanity-check (*overfit на нескольких батчах*).
   * Логируйте процесс в TensorBoard (лосс, accuracy, learning rate, гистограммы весов/градиентов).

3. **ViT-Tiny (linear probe)**

   * Загрузите предобученный ViT-Tiny (через `timm` или `torchvision`).
   * Заморозьте все слои бэкона.
   * Обучите линейную «голову» на своём датасете.

4. **Профилировка и логирование**

   * Используйте `torch.profiler`, соберите один trace (50–100 шагов).
   * Сравните CNN и ViT-Tiny по профилю ресурсов.

5. **Сравнение моделей**

   * Сравните CNN и ViT-Tiny по метрикам (accuracy, macro-F1).
   * Постройте confusion matrix.
   * Зафиксируйте ключевые наблюдения: кто быстрее сходится, у кого лучше обобщение, где узкие места.

---

### Требования к сдаче

* Сдавать в виде **репозитория на GitHub**.
* В репозитории должны быть:

  * код с комментариями (структура `src/` или ноутбуки);
  * `README.md` с инструкцией запуска и описанием экспериментов;
  * сохранённые логи TensorBoard (папка `runs/` или ссылка);
  * сохранённый trace профайлера;
  * таблица метрик (accuracy, F1) и confusion matrix (можно в `.png`/`.csv`);
  * краткие выводы в `README.md` (1–2 страницы текста в разметке Markdown).

---

### Критерии оценки

| Баллы | Критерий                                                                                                                         |
| ----- | -------------------------------------------------------------------------------------------------------------------------------- |
| 0–3   | **Полнота выполнения** — выполнены все этапы (CNN + ViT-Tiny + sanity-checks + профилировка).                                    |
| 0–3   | **Качество кода** — рабочий, читаемый, структурированный, с комментариями.                                                       |
| 0–2   | **Глубина анализа** — содержательные выводы в `README.md` с опорой на логи, метрики и графики.                                   |
| 0–2   | **Качество оформления** — аккуратный и воспроизводимый репозиторий: читаемый README, сохранённые артефакты, отсутствие «мусора». |

**Максимум: 10 баллов.**

---

### Дополнительные условия

* **Дедлайн:** до начала 4-й недели курса.
* **Опоздание:**

  * до 7 дней включительно — минус 1 балл;
  * более 7 дней — минус 2 балла.
* **Плагиат:** работы с плагиатом оцениваются в 0 баллов.

---
